--[[ BEGIN DIGITAL SIGNATURE
UC8xiCBjgNVnSt+VrYAUwHZFerRHpg6k8rbfvOMXlUNUjSiMdN3TbsuZgQud63yprMhCw5X7S40cR+PIfnwOenRsMr35/Gj77ugr9brc1i+kJd8uuU/3Pwv3xUj8NqRfjssE3lt1jdG7l3IQKxEz72qB3QlVSljm0LoiMv4JAoKfd3VeB9J3ykEs4Eg7XvMRjaG7MjMhxGPtDG39fNhLIwrCYxTYDdbV9EWEQajVuIUEy0cFfOvXDZnCFqDVBiT3cU1CAAe8+qLwCqK5Kve7NtyTEY5/J6K/7eByuyF3u4AJxEk0QFndcqOMUTOuIbjYfB2N6rAaLdtSUBlArV8CeA==
END DIGITAL SIGNATURE ]]
-- Extron SMP 351 Plug-in
-- by Eric Urbaniak / QSC Boulder
-- July 2019
-- Version 1.1.0.0
-- Version Notes: Added IsRecording and IsPaused LED


PluginInfo = {
    Name = "Enterprise Manager~Extron~Extron SMP 351 v1.1",
    Version = "1.1",
    BuildVersion = "1.1.0.0",
    Id = "408446a1-dffb-4055-9bf6-295367109bb6",
    Description = "Extron SMP 351",
    Author = "QSC",
    IsManaged = true,
    Model = "SMP 351",
    Manufacturer = "Extron",
    Type = Reflect and Reflect.Types.CaptureDevice or 0
}

PageNames = {"Setup","Device Control","Video Configuration"}

function GetColor(props)
  return { 0, 73, 150 }
end

function GetPrettyName(props)
  return "Extron\rSMP 351\rv".. PluginInfo.Version
end

function GetPages(props) --optional function if plugin has multiple pages
  pages = {}
  for ix,name in ipairs(PageNames) do
    table.insert(pages,{name=PageNames[ix]})
  end
  return pages
end
--[=[
function GetModel(props) --optional function to define model if plugin supports more than one model
  model = {}
  --[[ Model File Contents ]]
  return model
end
--]=]

function GetProperties()
  props = {
  }
  return props
end

function GetControls(props)
  ctrls = {
  {Name="IPAddress",ControlType="Text",Count=1},
  {Name="Port",ControlType="Knob",ControlUnit="Integer",DefaultValue=23,Min=1,Max=65535,Count=1},
  {Name="Password",ControlType="Text",Count=1},
  {Name="DevInfo",ControlType="Indicator",IndicatorType="Text",Count=4},
  {Name="StoInfo",ControlType="Indicator",IndicatorType="Text",Count=12},
  {Name="Status",ControlType="Indicator",IndicatorType=Reflect and "StatusGP" or "Status",Count=1,UserPin=true,PinStyle="Output"},
  {Name="InChanA",ControlType="Button",ButtonType="Trigger",Count=2,UserPin=true,PinStyle="Both"},
  {Name="InChanB",ControlType="Button",ButtonType="Trigger",Count=3,UserPin=true,PinStyle="Both"},
  {Name="VideoMute",ControlType="Button",ButtonType="Toggle",Count=2,UserPin=true,PinStyle="Both"},
  {Name="AudioMute",ControlType="Button",ButtonType="Toggle",Count=10,UserPin=true,PinStyle="Both"},
  {Name="Mark",ControlType="Button",ButtonType="Trigger",Count=1,UserPin=true,PinStyle="Both"},
  {Name="Record",ControlType="Button",ButtonType="Trigger",IconType="Icon",Icon="Record",IconColor={0,0,0},Count=1,UserPin=true,PinStyle="Both"},
  {Name="IsRecording",ControlType="Indicator",IndicatorType="LED",Count=1,UserPin=true,PinStyle="Output"},
  {Name="Pause",ControlType="Button",ButtonType="Trigger",IconType="Icon",Icon="Pause",Count=1,UserPin=true,PinStyle="Both"},
  {Name="IsPaused",ControlType="Indicator",IndicatorType="LED",Count=1,UserPin=true,PinStyle="Output"},
  {Name="Stop",ControlType="Button",ButtonType="Trigger",IconType="Icon",Icon="Stop",Count=1,UserPin=true,PinStyle="Both"},
  {Name="RecInfo",ControlType="Indicator",IndicatorType="Text",Count=3},
  {Name="TestPatImg",ControlType="Button",ButtonType="Trigger",Count=1},
  {Name="TestPat",ControlType="Text",TextBoxType="ComboBox",Count=1},
  {Name="VidLayout",ControlType="Text",TextBoxType="ComboBox",Count=1},
  {Name="EncLayout",ControlType="Text",TextBoxType="ComboBox",Count=2},
  {Name="StmLayout",ControlType="Text",TextBoxType="ComboBox",Count=2},
  {Name="RefNames",ControlType="Button",ButtonType="Trigger",Count=1,UserPin=true,PinStyle="Input"}
  }
  return ctrls
end

function GetControlLayout(props,ctrls)
  layout   = {}
  graphics = {}
  -- Local Variables
  local CurrentPage = PageNames[props["page_index"].Value]
  Extron="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"
  
  -- Color Lookup Table
  local Black     = {0  ,0  ,0  }
  local White     = {255,255,255}
  local BGGray    = {230,230,230}
  local EBlue     = {0  ,73 ,150}
  local Trans     = {0  ,0  ,0  ,0  }
  
  -- Lookup Tables
  Icons={
    "record",
    "pause",
    "stop"
  }
  VidLabel={
    "Channel A",
    "Channel B"
  }
  AudLabel={
    "Analog A",
    "Analog A",
    "Digital A",
    "Digital A",
    "Analog B",
    "Analog B",
    "Digital B",
    "Digital B",
    "Main Out",
    "Main Out"
  }
  AudPrettyNames={
    "Analog A Left",
    "Analog A Right",
    "Digital A Left",
    "Digital A Right",
    "Analog B Left",
    "Analog B Right",
    "Digital B Left",
    "Digital B Right",
    "Main Out Left",
    "Main Out Right"
  }
  ChanBInput={
    "Channel B Input 3",
    "Channel B Input 4",
    "Channel B Input 5"
  }
  
  
  -- Position Functions
  local function GetIPos(qty, rowlen, base, ofs)
    local row,col = (qty-1)//(rowlen),(qty-1)%rowlen
    return {base.x+col*ofs.x,base.y+row*ofs.y}
  end
  
  local function VerticalRows(qty, collen, base, ofs)
    local row,col = (qty-1)%collen,(qty-1)//(collen)
    return {base.x+col*ofs.x,base.y+row*ofs.y}
  end
  
  
  -- Control layout
  if CurrentPage=="Setup" then   -- Control Page
  
    -- Controls
    layout["IPAddress"]={Style="Text",PrettyName="IP Address",Position={75,113},Size={101,18},Color=White,Padding=0}
    layout["Port"]={Style="Text",PrettyName="Device's Port",Position={190,113},Size={101,18},Color=White,Padding=0}
    layout["Password"]={Style="Text",PrettyName="Device's Password",Position={304,113},Size={101,18},Color=White,Padding=0}
    for i=1,4 do
      layout["DevInfo "..i]={Style="Indicator",IndicatorType="Text",PrettyName="Device Information "..i,Position=GetIPos(i,4,{x=29,y=229},{x=116,y=0}),Size={100,18},Color=White,Padding=0}
    end
    for i=1,12 do
      layout["StoInfo "..i]={Style="Indicator",IndicatorType="Text",PrettyName="Storage Information "..i,Position=VerticalRows(i,3,{x=70,y=310},{x=106,y=32}),Size={100,18},Color=White,Padding=0}
    end
    layout["Status"]={Style="Indicator",IndicatorType="Status",PrettyName="Connection Status ",Position={66,438},Size={373,32},Color=White,FontSize=12,Padding=0}
  
    -- Graphics
      -- Group Boxes
    table.insert(graphics,{Type="GroupBox",StrokeWidth=0,CornerRadius=0,Fill=White,Position={0,0},Size={504,498}})
    table.insert(graphics,{Type="GroupBox",StrokeWidth=0,CornerRadius=0,Fill=BGGray,Position={0,0},Size={504,48}})
    table.insert(graphics,{Type="GroupBox",StrokeWidth=0,CornerRadius=0,Fill=BGGray,Position={8,73},Size={488,77}})
    table.insert(graphics,{Type="GroupBox",StrokeWidth=0,CornerRadius=0,Fill=BGGray,Position={8,175},Size={488,315}})
      -- Headers
    table.insert(graphics,{Type="Header",Text="Connect to Device",FontSize=16,Position={20,81},Size={464,6}})
    table.insert(graphics,{Type="Header",Text="Device Information",FontSize=16,Position={20,191},Size={464,6}})
    table.insert(graphics,{Type="Header",Text="Storage Information",FontSize=16,Position={20,269},Size={464,6}})
    table.insert(graphics,{Type="Header",Text="Connection Status",FontSize=16,Position={20,416},Size={464,6}})
      -- Text
    table.insert(graphics,{Type="Label",Text="Connection Setup",Position={8,49},Size={150,22},Color=EBlue,FontSize=18,Font="Roboto",FontStyle="Bold",HTextAlign="Left"})
    table.insert(graphics,{Type="Label",Text="Device Information",Position={8,153},Size={160,22},Color=EBlue,FontSize=18,Font="Roboto",FontStyle="Bold",HTextAlign="Left"})
    table.insert(graphics,{Type="Label",Text="IP Address",Position={75,96},Size={101,18},FontSize=14})
    table.insert(graphics,{Type="Label",Text="Port",Position={190,96},Size={101,18},FontSize=14})
    table.insert(graphics,{Type="Label",Text="Password",Position={304,96},Size={101,18},FontSize=14})
    table.insert(graphics,{Type="Label",Text="Device Name",Position={29,211},Size={100,18},FontSize=14})
    table.insert(graphics,{Type="Label",Text="Device Model",Position={145,211},Size={100,18},FontSize=14})
    table.insert(graphics,{Type="Label",Text="Firmware",Position={260,211},Size={100,18},FontSize=14})
    table.insert(graphics,{Type="Label",Text="Serial Number",Position={376,211},Size={100,18},FontSize=14})
    table.insert(graphics,{Type="Label",Text="Internal",Position={70,293},Size={100,18},FontSize=14})
    table.insert(graphics,{Type="Label",Text="Front USB",Position={176,293},Size={100,18},FontSize=14})
    table.insert(graphics,{Type="Label",Text="Rear USB",Position={281,293},Size={100,18},FontSize=14})
    table.insert(graphics,{Type="Label",Text="RCP USB",Position={387,293},Size={100,18},FontSize=14})
    table.insert(graphics,{Type="Label",Text="Available:",Position={8,310},Size={58,18},FontSize=12,HTextAlign="Right"})
    table.insert(graphics,{Type="Label",Text="Used:",Position={32,373},Size={34,18},FontSize=12,HTextAlign="Right"})
    table.insert(graphics,{Type="Label",Text="Total:",Position={28,342},Size={38,18},FontSize=12,HTextAlign="Right"})
      -- Version Number
    table.insert(graphics,{Type="Label",Text=string.format("Version %s",PluginInfo.Version),Position={433,477},Size={60,12},FontSize=9,HTextAlign="Right"})
      -- Logos
    table.insert(graphics,{Type="Image",Position={173,7},Size={158,35},Image=Extron})
  
  elseif CurrentPage=="Device Control" then
  
    -- Controls
    for i=1,2 do
      layout["InChanA "..i]={Style="Button",ButtonStyle="Trigger",PrettyName="Channel A Inputs~Channel A Input "..i,FontSize=11,Legend="Input "..i,Position=GetIPos(i,1,{x=36,y=122},{x=0,y=26}),Size={81,26}}
      layout["VideoMute "..i]={Style="Button",ButtonStyle="Toggle",PrettyName="Video Mute~"..VidLabel[i],FontSize=11,Legend=VidLabel[i],Position=GetIPos(i,2,{x=36,y=266},{x=0103,y=0}),Size={81,26}}
    end
    for i=1,3 do
      layout["InChanB "..i]={Style="Button",ButtonStyle="Trigger",PrettyName="Channel B Inputs~"..ChanBInput[i],FontSize=11,Legend="Input "..i+2,Position=GetIPos(i,1,{x=139,y=122},{x=0,y=26}),Size={81,26}}
      layout["RecInfo "..i]={Style="Indicator",IndicatorType="Text",PrettyName="Storage Information",Position=GetIPos(i,2,{x=21,y=620},{x=116,y=46}),Size={100,18},Color=White,Padding=0}
    end
    for i=1,10 do
      layout["AudioMute "..i]={Style="Button",ButtonStyle="Toggle",PrettyName="Audio Mute~"..AudPrettyNames[i],FontSize=11,Legend=AudLabel[i],Position=GetIPos(i,2,{x=36,y=338},{x=103,y=26}),Size={81,26}}
    end
    layout["Record"]={Style="Button",ButtonStyle="Trigger",PrettyName="Recording Controls~Record",Position={38,517},Size={40,40}}
    layout["IsRecording"]={Style="None",PrettyName="Recording Controls~Is Recording"}
    layout["Pause"]={Style="Button",ButtonStyle="Trigger",PrettyName="Recording Controls~Pause",Position={78,517},Size={40,40}}
    layout["IsPaused"]={Style="None",PrettyName="Recording Controls~Is Paused"}
    layout["Stop"]={Style="Button",ButtonStyle="Trigger",PrettyName="Recording Controls~Stop",Position={118,517},Size={40,40}}
    layout["Mark"]={Style="Button",ButtonStyle="Trigger",PrettyName="Recording Controls~Mark",Padding=2,FontSize=11,Legend="Mark",Position={178,517},Size={40,40}}
  
  
    -- Graphics
      -- Group Boxes
    table.insert(graphics,{Type="GroupBox",StrokeWidth=0,CornerRadius=0,Fill=White,Position={0,0},Size={256,708}})
    table.insert(graphics,{Type="GroupBox",StrokeWidth=0,CornerRadius=0,Fill=BGGray,Position={0,0},Size={256,48}})
    table.insert(graphics,{Type="GroupBox",StrokeWidth=0,CornerRadius=0,Fill=BGGray,Position={8,70},Size={240,630}})
    table.insert(graphics,{Type="GroupBox",StrokeWidth=1,CornerRadius=2,Fill=Trans,Position={33,119},Size={87,58}})
    table.insert(graphics,{Type="GroupBox",StrokeWidth=1,CornerRadius=2,Fill=Trans,Position={136,119},Size={87,84}})
    table.insert(graphics,{Type="GroupBox",StrokeWidth=1,CornerRadius=2,Fill=Trans,Position={33,263},Size={189,32}})
    table.insert(graphics,{Type="GroupBox",StrokeWidth=1,CornerRadius=2,Fill=Trans,Position={33,335},Size={189,136}})
  
  
      -- Headers
    table.insert(graphics,{Type="Header",Text="Inputs",FontSize=16,Position={14,86},Size={228,6}})
    table.insert(graphics,{Type="Header",Text="A/V Mute",FontSize=16,Position={14,222},Size={228,6}})
    table.insert(graphics,{Type="Header",Text="Recording",FontSize=16,Position={14,488},Size={228,6}})
    table.insert(graphics,{Type="Header",Text="Recording Information",FontSize=16,Position={14,582},Size={228,6}})
     -- Text
    table.insert(graphics,{Type="Label",Text="Device Control",Position={8,49},Size={139,22},Color=EBlue,FontSize=18,Font="Roboto",FontStyle="Bold",HTextAlign="Left"})
    table.insert(graphics,{Type="Label",Text="Channel A",Position={33,104},Size={87,13},FontSize=12})
    table.insert(graphics,{Type="Label",Text="Channel B",Position={136,104},Size={87,13},FontSize=12})
    table.insert(graphics,{Type="Label",Text="Video",Position={86,246},Size={84,18},FontSize=14})
    table.insert(graphics,{Type="Label",Text="Audio",Position={86,308},Size={84,18},FontSize=14})
    table.insert(graphics,{Type="Label",Text="Left Channel",Position={35,320},Size={84,18},FontSize=12})
    table.insert(graphics,{Type="Label",Text="Right Channel",Position={133,320},Size={94,18},FontSize=12})
    table.insert(graphics,{Type="Label",Text="Elapsed Time",Position={21,602},Size={100,18},FontSize=14})
    table.insert(graphics,{Type="Label",Text="Time Remaining",Position={132,602},Size={108,18},FontSize=14})
    table.insert(graphics,{Type="Label",Text="Destination",Position={21,648},Size={100,18},FontSize=14})
      -- Logos
    table.insert(graphics,{Type="Image",Position={49,7},Size={158,35},Image=Extron})
  
  elseif CurrentPage=="Video Configuration" then
  
    -- Controls
    layout["TestPatImg"]={Style="Button",ButtonStyle="Trigger",PrettyName="Test Pattern Image",Position={31,108},Size={191,107}}
    layout["TestPat"]={Style="ComboBox",PrettyName="Test Pattern",Position={63,243},Size={130,18},Color=White,FontSize=12}
    layout["VidLayout"]={Style="ComboBox",PrettyName="Video Layout Preset",Position={63,314},Size={130,18},Color=White,FontSize=12}
    for i=1,2 do
      layout["EncLayout "..i]={Style="ComboBox",PrettyName="Encoder "..i.." Layout Preset",Position=GetIPos(i,2,{x=14,y=362},{x=116,y=0}),Size={113,18},Color=White,FontSize=12}
      layout["StmLayout "..i]={Style="ComboBox",PrettyName="Streaming "..i.." Layout Preset",Position=GetIPos(i,2,{x=14,y=410},{x=116,y=0}),Size={113,18},Color=White,FontSize=12}
    end
    layout["RefNames"]={Style="Button",ButtonStyle="Trigger",PrettyName="Refresh Preset Names",Position={164,439},Size={36,16}}
  
    -- Graphics
      --Group Boxes
    table.insert(graphics,{Type="GroupBox",StrokeWidth=0,CornerRadius=0,Fill=White,Position={0,0},Size={256,473}})
    table.insert(graphics,{Type="GroupBox",StrokeWidth=0,CornerRadius=0,Fill=BGGray,Position={0,0},Size={256,48}})
    table.insert(graphics,{Type="GroupBox",StrokeWidth=0,CornerRadius=0,Fill=BGGray,Position={8,71},Size={240,394}})
      -- Headers
    table.insert(graphics,{Type="Header",Text="Streaming",FontSize=16,Position={14,87},Size={228,6}})
    table.insert(graphics,{Type="Header",Text="Video Presets",FontSize=16,Position={14,279},Size={228,6}})
      -- Text
    table.insert(graphics,{Type="Label",Text="Video Configuration",Position={8,49},Size={172,22},Color=EBlue,FontSize=18,Font="Roboto",FontStyle="Bold",HTextAlign="Left"})
    table.insert(graphics,{Type="Label",Text="Test Pattern",Position={77,225},Size={100,18},FontSize=14})
    table.insert(graphics,{Type="Label",Text="Layout",Position={77,296},Size={100,18},FontSize=14})
    table.insert(graphics,{Type="Label",Text="Encoder A",Position={25,344},Size={87,18},FontSize=14})
    table.insert(graphics,{Type="Label",Text="Encoder B",Position={141,344},Size={87,18},FontSize=14})
    table.insert(graphics,{Type="Label",Text="Streaming A",Position={21,392},Size={100,18},FontSize=14})
    table.insert(graphics,{Type="Label",Text="Streaming B",Position={137,392},Size={100,18},FontSize=14})
    table.insert(graphics,{Type="Label",Text="Refresh Names:",Position={57,437},Size={105,18},FontSize=14})
      -- Logos
    table.insert(graphics,{Type="Image",Position={49,7},Size={158,35},Image=Extron})
  end
  return layout, graphics
end


--Start event based logic
if Controls then
  -- Extron SMP 351
  -- by Eric Urbaniak / QSC Boulder
  -- July 2019
  -- Version Notes: Added transport controls feedback 
  -- Notes:
  
  
  rapidjson=require("rapidjson")
  
  -- Control Aliases
  IPAddress=Controls.IPAddress
  Port=Controls.Port
  Password=Controls.Password
  Record=Controls.Record
  Recording=Controls.IsRecording
  Pause=Controls.Pause
  Paused=Controls.IsPaused
  Stop=Controls.Stop
  TestPat=Controls.TestPat
  VidLayout=Controls.VidLayout
  Status=Controls.Status
  TestPatImg=Controls.TestPatImg
  EncLayout=Controls.EncLayout
  StmLayout=Controls.StmLayout
  RefNames=Controls.RefNames
  Mark=Controls.Mark
  
  
  -- Sockets
  SMP=TcpSocket.New()
  
  
  -- Timers
  Heartbeat=Timer.New()
  RecTimer=Timer.New()
  CmdQTimer=Timer.New()
  
  
  -- Lookup Tables
  status_state={OK=0,COMPROMISED=1,FAULT=2,NOTPRESENT=3,MISSING=4,INITIALIZING=5}
  VidLayOpt={}
  RxData={}
  RecTimes={}
  AudMuteData={}
  VidMuteData={}
  CmdQ={}
  ParseQ={}
  EncLayOpt,StmLayOpt={},{}
  EncLayOpt2=EncLayOpt
  StmLayOpt2=StmLayOpt
  TestPatOpt={
    "None",
    "Color Bars",
    "Aspect Ratio 1.33",
    "Aspect Ratio 1.78",
    "Aspect Ratio 1.85",
    "Crop","Pulse",
    "Timestamp",
    "Universal OSD"
  }
  SelTestPat={
    {DrawChrome=false,IconData="PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxOTEgMTA3Ij48dGl0bGU+VGVzdCBQYXR0ZXJuczwvdGl0bGU+PGcgaWQ9Ik5vbmUiPjxyZWN0IGlkPSJCRyIgd2lkdGg9IjE5MSIgaGVpZ2h0PSIxMDciLz48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg3My4zNyA1Ny4xMSkiIHN0eWxlPSJmb250LXNpemU6MTJweDtmaWxsOiNmZmY7Zm9udC1mYW1pbHk6TXlyaWFkUHJvLVJlZ3VsYXIsIE15cmlhZCBQcm8iPiZsdDtOT05FJmd0OzwvdGV4dD48L2c+PC9zdmc+"},
    {DrawChrome=false,IconData="PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxOTEgMTA3Ij48dGl0bGU+VGVzdCBQYXR0ZXJuczwvdGl0bGU+PGcgaWQ9IkNvbG9yX0JhcnMiIGRhdGEtbmFtZT0iQ29sb3IgQmFycyI+PHJlY3Qgd2lkdGg9IjI0IiBoZWlnaHQ9IjUzIiBzdHlsZT0iZmlsbDojZmZmIi8+PHJlY3QgeD0iMjQiIHdpZHRoPSIyNCIgaGVpZ2h0PSI1MyIgc3R5bGU9ImZpbGw6I2VmZTkxOSIvPjxyZWN0IHg9IjQ4IiB3aWR0aD0iMjQiIGhlaWdodD0iNTMiIHN0eWxlPSJmaWxsOiM2ZmNjZGIiLz48cmVjdCB4PSI3MiIgd2lkdGg9IjI0IiBoZWlnaHQ9IjUzIiBzdHlsZT0iZmlsbDojNmNiZTQ1Ii8+PHJlY3QgeD0iOTYiIHdpZHRoPSIyNCIgaGVpZ2h0PSI1MyIgc3R5bGU9ImZpbGw6I2I5NTA5ZSIvPjxyZWN0IHg9IjEyMCIgd2lkdGg9IjI0IiBoZWlnaHQ9IjUzIiBzdHlsZT0iZmlsbDojZWIyMzI5Ii8+PHJlY3QgeD0iMTQ0IiB3aWR0aD0iMjQiIGhlaWdodD0iNTMiIHN0eWxlPSJmaWxsOiMzODU0YTQiLz48cmVjdCB4PSIxNjgiIHdpZHRoPSIyMyIgaGVpZ2h0PSI1MyIgc3R5bGU9ImZpbGw6IzA3MDkwOSIvPjxyZWN0IHg9IjE2OCIgeT0iNTMiIHdpZHRoPSIyMyIgaGVpZ2h0PSI1NCIgc3R5bGU9ImZpbGw6I2ZmZiIvPjxyZWN0IHk9IjUzIiB3aWR0aD0iMjQiIGhlaWdodD0iNTQiIHN0eWxlPSJmaWxsOiMwNzA5MDkiLz48cmVjdCB4PSIyNCIgeT0iNTMiIHdpZHRoPSIyNCIgaGVpZ2h0PSI1NCIgc3R5bGU9ImZpbGw6IzM4NTRhNCIvPjxyZWN0IHg9IjQ4IiB5PSI1MyIgd2lkdGg9IjI0IiBoZWlnaHQ9IjU0IiBzdHlsZT0iZmlsbDojZWIyMzI5Ii8+PHJlY3QgeD0iNzIiIHk9IjUzIiB3aWR0aD0iMjQiIGhlaWdodD0iNTQiIHN0eWxlPSJmaWxsOiNiOTUwOWUiLz48cmVjdCB4PSI5NiIgeT0iNTMiIHdpZHRoPSIyNCIgaGVpZ2h0PSI1NCIgc3R5bGU9ImZpbGw6IzZjYmU0NSIvPjxyZWN0IHg9IjEyMCIgeT0iNTMiIHdpZHRoPSIyNCIgaGVpZ2h0PSI1NCIgc3R5bGU9ImZpbGw6IzZmY2NkYiIvPjxyZWN0IHg9IjE0NCIgeT0iNTMiIHdpZHRoPSIyNCIgaGVpZ2h0PSI1NCIgc3R5bGU9ImZpbGw6I2VmZTkxOSIvPjwvZz48L3N2Zz4="},
    {DrawChrome=false,IconData="PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxOTEgMTA3Ij48dGl0bGU+VGVzdCBQYXR0ZXJuczwvdGl0bGU+PGcgaWQ9IkFSXzEuMzMiIGRhdGEtbmFtZT0iQVIgMS4zMyI+PHJlY3QgaWQ9IkJHIiB3aWR0aD0iMTkxIiBoZWlnaHQ9IjEwNyIvPjxyZWN0IHg9IjI2LjUiIHk9IjIuNSIgd2lkdGg9IjEzNyIgaGVpZ2h0PSIxMDMiIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiNmZmY7c3Ryb2tlLW1pdGVybGltaXQ6MTAiLz48L2c+PC9zdmc+"},
    {DrawChrome=false,IconData="PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxOTEgMTA3Ij48dGl0bGU+VGVzdCBQYXR0ZXJuczwvdGl0bGU+PGcgaWQ9IkFSXzEuNzgiIGRhdGEtbmFtZT0iQVIgMS43OCI+PHJlY3QgaWQ9IkJHIiB3aWR0aD0iMTkxIiBoZWlnaHQ9IjEwNyIvPjxyZWN0IHg9IjQuNSIgeT0iMTAuNTYiIHdpZHRoPSIxODIiIGhlaWdodD0iODUuODgiIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiNmZmY7c3Ryb2tlLW1pdGVybGltaXQ6MTAiLz48L2c+PC9zdmc+"},
    {DrawChrome=false,IconData="PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxOTEgMTA3Ij48dGl0bGU+VGVzdCBQYXR0ZXJuczwvdGl0bGU+PGcgaWQ9IkFSXzEuODUiIGRhdGEtbmFtZT0iQVIgMS44NSI+PHJlY3QgaWQ9IkJHIiB3aWR0aD0iMTkxIiBoZWlnaHQ9IjEwNyIvPjxyZWN0IHg9IjUuNSIgeT0iMjAuNDQiIHdpZHRoPSIxODAiIGhlaWdodD0iNjYuMTMiIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiNmZmY7c3Ryb2tlLW1pdGVybGltaXQ6MTAiLz48L2c+PC9zdmc+"},
    {DrawChrome=false,IconData="PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxOTEgMTA3Ij48dGl0bGU+VGVzdCBQYXR0ZXJuczwvdGl0bGU+PGcgaWQ9IkNyb3AiPjxyZWN0IGlkPSJCRyIgd2lkdGg9IjE5MSIgaGVpZ2h0PSIxMDciLz48cmVjdCB4PSIyLjUiIHk9IjIuNSIgd2lkdGg9IjE4NiIgaGVpZ2h0PSIxMDIiIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiNmZmY7c3Ryb2tlLW1pdGVybGltaXQ6MTAiLz48L2c+PC9zdmc+"},
    {DrawChrome=false,IconData="PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxOTEgMTA3Ij48dGl0bGU+VGVzdCBQYXR0ZXJuczwvdGl0bGU+PGcgaWQ9IlB1bHNlIj48cmVjdCBpZD0iQkciIHdpZHRoPSIxOTEiIGhlaWdodD0iMTA3Ii8+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNTYuNTIgNTcuMTEpIiBzdHlsZT0iZm9udC1zaXplOjEycHg7ZmlsbDojZmZmO2ZvbnQtZmFtaWx5Ok15cmlhZFByby1SZWd1bGFyLCBNeXJpYWQgUHJvIj4mbHQ7PHRzcGFuIHg9IjcuMTUiIHk9IjAiIHN0eWxlPSJsZXR0ZXItc3BhY2luZzotMC4wMjc5OTQ3OTE2NjY2NjY2NjhlbSI+QTwvdHNwYW4+PHRzcGFuIHg9IjE0LjE2IiB5PSIwIj5VRElPPC90c3Bhbj48dHNwYW4geD0iNDEuMDUiIHk9IjAiIHN0eWxlPSJsZXR0ZXItc3BhY2luZzotMC4wNDA5NzQ5MzQ4OTU4MzMzMzZlbSI+IDwvdHNwYW4+PHRzcGFuIHg9IjQzLjEiIHk9IjAiIHN0eWxlPSJsZXR0ZXItc3BhY2luZzotMC4wMjcwMTgyMjkxNjY2NjY2NjhlbSI+VDwvdHNwYW4+PHRzcGFuIHg9IjQ4Ljc0IiB5PSIwIj5PTkUmZ3Q7PC90c3Bhbj48L3RleHQ+PC9nPjwvc3ZnPg=="},
    {DrawChrome=false,IconData="PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxOTEgMTA3Ij48dGl0bGU+VGVzdCBQYXR0ZXJuczwvdGl0bGU+PGcgaWQ9IlRpbWVzdGFtcCI+PHJlY3QgaWQ9IkJHIiB3aWR0aD0iMTkxIiBoZWlnaHQ9IjEwNyIvPjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDMuMjcgMTAuOSkiIHN0eWxlPSJmb250LXNpemU6MTBweDtmaWxsOiNmZmY7Zm9udC1mYW1pbHk6Q29uc29sYXMiPkZyaSBBcHIgMTggMTE6MTA6MzI8L3RleHQ+PC9nPjwvc3ZnPg=="},
    {DrawChrome=false,IconData="PHN2ZyBpZD0iVW5pdmVyc2FsX09TRCIgZGF0YS1uYW1lPSJVbml2ZXJzYWwgT1NEIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxOTEgMTA3Ij48dGl0bGU+VFAwOTwvdGl0bGU+PHJlY3QgaWQ9IkJHIiB3aWR0aD0iMTkxIiBoZWlnaHQ9IjEwNyIvPjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDQgMTAuOSkiIHN0eWxlPSJmb250LXNpemU6MTBweDtmaWxsOiNmZmY7Zm9udC1mYW1pbHk6Q29uc29sYXMiPlNBTVBMRSBURVhUPC90ZXh0Pjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDIzLjQ1IDYxLjMyKSIgc3R5bGU9ImZvbnQtc2l6ZToxMnB4O2ZpbGw6I2ZmZjtmb250LWZhbWlseTpNeXJpYWRQcm8tUmVndWxhciwgTXlyaWFkIFBybyI+Jmx0Ozx0c3BhbiB4PSI3LjE1IiB5PSIwIiBzdHlsZT0iZm9udC1mYW1pbHk6Q2FsaWJyaSI+Q288L3RzcGFuPjx0c3BhbiB4PSIxOS44OCIgeT0iMCIgc3R5bGU9ImZvbnQtZmFtaWx5OkNhbGlicmk7bGV0dGVyLXNwYWNpbmc6LTAuMDA1ODU5Mzc1ZW0iPm48L3RzcGFuPjx0c3BhbiB4PSIyNi4xMSIgeT0iMCIgc3R5bGU9ImZvbnQtZmFtaWx5OkNhbGlicmkiPmZpZ3U8L3RzcGFuPjx0c3BhbiB4PSI0NC40MiIgeT0iMCIgc3R5bGU9ImZvbnQtZmFtaWx5OkNhbGlicmk7bGV0dGVyLXNwYWNpbmc6LTAuMDEzMTgzNTkzNzVlbSI+cjwvdHNwYW4+PHRzcGFuIHg9IjQ4LjQ0IiB5PSIwIiBzdHlsZT0iZm9udC1mYW1pbHk6Q2FsaWJyaSI+ZSB1c2luZyA8L3RzcGFuPjx0c3BhbiB4PSI4NS41NCIgeT0iMCIgc3R5bGU9ImZvbnQtZmFtaWx5OkNhbGlicmk7bGV0dGVyLXNwYWNpbmc6LTAuMDA4Nzg5MDYyNWVtIj53PC90c3Bhbj48dHNwYW4geD0iOTQuMDIiIHk9IjAiIHN0eWxlPSJmb250LWZhbWlseTpDYWxpYnJpIj5lYiB1dGlsaXR5PC90c3Bhbj48dHNwYW4geD0iMTM2Ljk1IiB5PSIwIj4mZ3Q7PC90c3Bhbj48L3RleHQ+PC9zdmc+"},
  }
  MuteCmd={
    "40000",
    "40001",
    "40002",
    "40003",
    "40004",
    "40005",
    "40006",
    "40007",
    "60000",
    "60001"
  }
  TransCtrls={
    Record,
    Pause,
    Stop
  }
  TransColor={
    "Red",
    "LightGray",
    "LightGray"
  }
  QueryCmds={
    DevInfo={
      "WCN|",  --Device Name
      "1I",  --Device Model
      "Q", --Firmware Version
      "99I"  --Serial Number
    },
    StoInfo={
      "55I", --Internal Storage
      "56I",  --Front USB
      "57I",  --Rear USB
      "58I"  --RCP USB
    },
    RecInfo={
      "37I",  --Destination
      "36I",  --Time Remaining
      "35I"   --Elapsed Time
    }
  }
  
  
  -- Global Variables
  TestPat.Choices=TestPatOpt
  VidLayout.Choices=VidLayOpt
  HBTime=5
  RecTime=1
  QTime=.1
  LoginCnt=0
  SMP.ReadTimeout=5
  SMP.ReconnectTimeout=5
  SMP.WriteTimeout=5
  TNCon=false
  recTimer=false
  VidLayout.String="Select Preset"
  for i=1,2 do
    EncLayout[i].String="Select Preset"
    StmLayout[i].String="Select Preset"
  end
  
  
  -- Functions
  function Init()
    DevIP=IPAddress.String
    DevPort=Port.Value
    DevPass=Password.String
    if DevIP=="" then ReportStatus("MISSING", "No IP Address") end
    CmdQTimer:Start(QTime)
    Connect()
  end
  
  function TablePretty(tbl,sort)
    return rapidjson.encode(tbl,{pretty=true,sort_keys=sort})
  end
  
  function ReportStatus(state,msg)
    Status.Value=status_state[state]
    Status.String=msg
  end
  
  function Connect()
    if DevIP~="" and DevPort~="" then
      SMP:Connect(DevIP,math.floor(DevPort))
    end 
  end
  
  function IsConnected()
    return SMP.IsConnected
  end
  
  function Disconnected()
    if not IsConnected() then
      Heartbeat:Stop()
      RecTimer:Stop()
      recTimer=false
      VidLayOpt,RxData,RecTimes,AudMuteData,VidMuteData,CmdQ,ParseQ,EncLayOpt,StmLayOpt,IntStoData={},{},{},{},{},{},{},{},{},{}
      EncLayOpt2=EncLayOpt
      StmLayOpt2=StmLayOpt
      for i=1,2 do Controls.VideoMute[i].Color="Gray" Controls.InChanA[i].Color="Gray" end
      for i=1,3 do Controls.RecInfo[i].String="" Controls.InChanB[i].Color="Gray" TransCtrls[i].Color="Gray" end
      for i=1,4 do Controls.DevInfo[i].String="" end
      for i=1,10 do Controls.AudioMute[i].Color="Gray" end 
      for i=1,12 do Controls.StoInfo[i].String="" end
    end
  end
  
  function Send(cmd)
    if cmd~=nil then
      SMP:Write(cmd)
    else
      SMP:Write(CmdQ[1][1].."\r")
      table.insert(ParseQ,CmdQ[1])
      table.remove(CmdQ,1)
    end 
  end
  
  function SendQ(cmd,cmdtype)
    if IsConnected() then
      if cmdtype~="PollTime" then
        table.insert(CmdQ,{cmd,cmdtype})
      else
        table.insert(CmdQ,1,{cmd,cmdtype})
      end
    end
  end
  
    -- Polling functions
  function GetLayName()
    for i=1,16 do
      SendQ("W7*"..i.."PNAM|","LayName")
    end
    GetEncName()
  end
  
  function GetEncName()
    for i=1,32 do
      SendQ("W4*"..i.."PNAM|","EncName")
    end
    GetStmName()
  end
  
  function GetStmName()
    for i=1,32 do
      SendQ("W3*"..i.."PNAM|","StmName")
    end
    PollDevice()
    Heartbeat:Start(HBTime)
  end
  
  function PollDevice()
    GetDevInfo() 
  end
  
  function GetDevInfo()
    for i=1,4 do
      if not SentCmd then
        SendQ(QueryCmds.DevInfo[i],"PollDev")
      end
    end
    Timer.CallAfter(GetStoInfo,.5)
  end
  
  function GetStoInfo()
    for i=1,4 do
      if not SentCmd then
        SendQ(QueryCmds.StoInfo[i],"PollDev")
      end
    end
    Timer.CallAfter(GetTestPat,.5)
  end
  
  function GetRecInfo()
    for i=1,3 do
      if not SentCmd then
        SendQ(QueryCmds.RecInfo[i],"PollTime")
      end
    end
  end
  
  function GetTestPat()
    SendQ("WTEST|","PollDev")
    Timer.CallAfter(GetTransCtrl,.5)  
  end
  
  function GetTransCtrl()
    SendQ("WYRCDR|","PollDev")
    Timer.CallAfter(GetInputs,.5)
  end
  
  function GetInputs()
    for i=1,2 do
      SendQ(i.."!","PollInputs")
    end
    Timer.CallAfter(GetAudMute,.5)
  end
  
  function GetAudMute()
    for i=1,10 do
      SendQ("WM"..MuteCmd[i].."AU|","PollAudMute")
    end
    Timer.CallAfter(GetVidMute,.5)
  end
  
  function GetVidMute()
    for i=1,2 do 
      SendQ("0"..i.."B","PollVidMute")  
    end
  end
  
    -- Set returned data 
  function SetDevData()
    
    -- Set Device Information section
    for i=1,4 do
      Controls.DevInfo[i].String=RxData[i]
    end
    
    -- Process data for Internal Storage Information section
    IntStoData={}
    if RxData[5]~="N/A" then
      local fdata=string.gsub(RxData[5],"^%w(.-)%*","")
      for i=1,3 do
        local astkpos=string.find(fdata,"%*")
        if astkpos~=nil then
          val=string.sub(fdata,"1",astkpos-1)
          fdata=string.gsub(fdata,"^.(.-)%*","")
          table.insert(IntStoData,val)
        end     
      end 
    else
      for i=1,3 do
        local val="N/A"
        table.insert(IntStoData,val)
      end 
    end
    
    -- Process data for Front USB Storage Information section
    if RxData[6]~="N/A" then
      local fdata=string.gsub(RxData[6],"^%w(.-)%*","")
      for i=1,3 do
        local astkpos=string.find(fdata,"%*")
        if astkpos~=nil then
          val=string.sub(fdata,"1",astkpos-1)
          fdata=string.gsub(fdata,"^.(.-)%*","")
          table.insert(IntStoData,val)
        end     
      end 
    else
      for i=1,3 do
        local val="N/A"
        table.insert(IntStoData,val)
      end 
    end
    
    -- Process data for Rear USB Storage Information section
    if RxData[7]~="N/A" then
      local fdata=string.gsub(RxData[7],"^%w(.-)%*","")
      for i=1,3 do
        local astkpos=string.find(fdata,"%*")
        if astkpos~=nil then
          val=string.sub(fdata,"1",astkpos-1)
          fdata=string.gsub(fdata,"^.(.-)%*","")
          table.insert(IntStoData,val)
        end     
      end 
    else
      for i=1,3 do
        local val="N/A"
        table.insert(IntStoData,val)
      end 
    end
    
    -- Process data for RCP USB Storage Information section
    if RxData[8]~="N/A" then
      local fdata=string.gsub(RxData[8],"^%w(.-)%*","")
      for i=1,3 do
        local astkpos=string.find(fdata,"%*")
        if astkpos~=nil then
          val=string.sub(fdata,"1",astkpos-1)
          fdata=string.gsub(fdata,"^.(.-)%*","")
          table.insert(IntStoData,val)
        end      
      end 
    else
      for i=1,3 do
        local val="N/A"
        table.insert(IntStoData,val)
      end 
    end
    
    -- Set Storage Information section
    for i=1,12 do
      if IntStoData[i]==nil then IntStoData[i]="" end 
      Controls.StoInfo[i].String=IntStoData[i]
    end
    
    --[[
    -- Set Recording Information section
    for i=1,3 do
      local d=i+8
      if d>11 then d=9 end
      if i==2 then 
        local fdata=string.gsub(RxData[10],"internal ","")
        local fdata=string.gsub(fdata,"%*(.-)%d$","")
        table.remove(RxData,10)
        table.insert(RxData,10,fdata)
      elseif i==3 then
        local fdata=string.gsub(RxData[11],"%*(.-)%g$","")
        table.remove(RxData,11)
        table.insert(RxData,11,fdata)
      end
      Controls.RecInfo[i].String=RxData[d]
    end]]
    
    -- Set Test Pattern
    if type(tonumber(RxData[9]))=="number" then
      TestPat.String=TestPatOpt[math.floor(RxData[9])+1]
      DisplayTestPat(math.floor(RxData[9])+1)
    end
    
    -- Set Transport Control feedback
    if type(tonumber(RxData[10]))=="number" then
      tcdata=math.floor(RxData[10])
      if tcdata==0 then tcdata=3 end
      for i=1,3 do
        if i==tcdata then
          TransCtrls[i].Color=TransColor[i]
          if recTimer==false then
            RecTimer:Start(RecTime)
          end
        else
          TransCtrls[i].Color="Gray"
        end
      end
    end
    Recording.Boolean=Record.Color=="Red" and true or false
    Paused.Boolean=Pause.Color=="LightGray" and true or false
  end
  
  function SetRecInfo(RecTimes)
    for i=1,3 do
      if i==2 then 
        local fdata=string.gsub(RecTimes[2],"internal ","")
        local fdata=string.gsub(fdata,"%*(.-)%d$","")
        table.remove(RecTimes,2)
        table.insert(RecTimes,2,fdata)
      elseif i==3 then
        local fdata=string.gsub(RecTimes[3],"%*(.-)%g$","")
        table.remove(RecTimes,3)
        table.insert(RecTimes,3,fdata)
      end
      Controls.RecInfo[i].String=RecTimes[i]
    end
  end
  
  function SetAudMute()
    for i=1,10 do
      Controls.AudioMute[i].Color=AudMuteData[i]
    end
  end
  
  function SetVidMute()
    for i=1,2 do
      Controls.VideoMute[i].Color=VidMuteData[i]
    end
  end
  
  function DisplayTestPat(sel)
    TestPatImg.Legend=rapidjson.encode(SelTestPat[sel])
  end
  
    -- Telent connection functions
  function TelnetAuth()
    LoginCnt=LoginCnt+1
    Send(DevPass.."\r")
    if LoginCnt>3 then 
      ReportStatus("FAULT","Check Password")
    end  
  end
  
  function TelnetCon()
    ReportStatus("OK","")
    LoginCnt=0
    TNCon=true
    GetRecInfo()
    GetLayName()
  end
  
    -- Parser
  function ParseResponse(Rxdata)
    if #ParseQ ~= nil then
      if ParseQ[1][2]=="LayName" then
        if Rxdata=="E13" then Rxdata="[unassigned]" end
        table.insert(VidLayOpt,Rxdata)
        VidLayout.Choices=VidLayOpt
      elseif ParseQ[1][2]=="EncName" then
        if Rxdata=="E13" then Rxdata="[unassigned]" end
        table.insert(EncLayOpt,Rxdata)
        EncLayout[1].Choices=EncLayOpt
        EncLayout[2].Choices=EncLayOpt
      elseif ParseQ[1][2]=="StmName" then
        if Rxdata=="null" then Rxdata="[unassigned]" end
        table.insert(StmLayOpt,Rxdata)
        StmLayout[1].Choices=StmLayOpt
        StmLayout[2].Choices=StmLayOpt
      elseif ParseQ[1][2]=="PollDev" then
        table.insert(RxData,Rxdata)
        if #RxData==10 then
          SetDevData(RxData)
          RxData={}
        end
      elseif ParseQ[1][2]=="PollTime" then
        table.insert(RecTimes,Rxdata)
        if #RecTimes==3 then
          SetRecInfo(RecTimes)
          RecTimes={}
        end
      elseif ParseQ[1][2]=="SentCmd" then
        if Rxdata=="E10" then
          --print("E10: Unrecognized command")
        elseif Rxdata=="E13" then
          --print("E13: Invalid Parameter")
        elseif Rxdata=="E14" then
          --print("E14: Not valid for this configuration")
        elseif Rxdata=="E17" then
          --print("E17: Invalid command for signal type")
        elseif Rxdata=="E18" then
          --print("E18: System timed out")
        elseif Rxdata=="E22" then
          --print("E22: Busy")
        elseif Rxdata=="E24" then
          --print("E24: Privilege violation")
        elseif Rxdata=="E26" then
          --print("E26: Maximum connections exceeded")
        elseif Rxdata=="E28" then
          --print("E28: Bad file name or file not found")
        end
      elseif ParseQ[1][2]=="PollInputs" and type(tonumber(Rxdata))=="number" then
        In=math.floor(Rxdata)
        if In<3 then 
          for i=1,2 do
            if i==In then
              Controls.InChanA[i].Color="White"
            else
              Controls.InChanA[i].Color="Gray"
            end
          end
        else
          for i=3,5 do
            if i==In then
              Controls.InChanB[i-2].Color="White"
            else
              Controls.InChanB[i-2].Color="Gray"
            end
          end
        end
      elseif ParseQ[1][2]=="PollAudMute" and type(tonumber(Rxdata))=="number" then
        if tonumber(Rxdata)==1 then 
          astate="White"
        else
          astate="Gray"
        end
        table.insert(AudMuteData,astate)
        if #AudMuteData>9 then
          SetAudMute(AudMuteData)
          AudMuteData={}  
        end
      elseif ParseQ[1][2]=="PollVidMute" and type(tonumber(Rxdata))=="number" then
        if tonumber(Rxdata)==1 then 
          vstate="White"
        else
          vstate="Gray"
        end
        table.insert(VidMuteData,vstate)
        if #VidMuteData>1 then
          SetVidMute(VidMuteData)
          VidMuteData={}
        end 
      else
      end
      table.remove(ParseQ,1)
      if #ParseQ > 1 then
      elseif #ParseQ==0 then
      end
    end
  end
  
  
  --Event Handlers
    -- Setup Page
  IPAddress.EventHandler=function()
    DevIP=IPAddress.String
    Connect()
  end
  
  Port.EventHandler=function()
    DevPort=Port.Value
    Connect()
  end
  
  Password.EventHandler=function()
    DevPass=Password.String
    LoginCnt=0
    Connect()
  end
  
    -- Device Control Page
  for i=1,2 do 
    Controls.InChanA[i].EventHandler=function()
      SendQ(i.."*1!","SentCmd")
    end
  end
  
  for i=1,3 do 
    Controls.InChanB[i].EventHandler=function()
      local cmd=i+2
      SendQ(cmd.."*2!","SentCmd")
    end
  end
  
  for i=1,2 do
    Controls.VideoMute[i].EventHandler=function()
      if Controls.VideoMute[i].Color=="Gray" then
        SendQ(i.."*1B","SentCmd")
      else
        SendQ(i.."*0B","SentCmd")
      end
    end
  end
  
  for i=1,10 do 
    Controls.AudioMute[i].EventHandler=function()
      if Controls.AudioMute[i].Color=="Gray" then
        if i<9 then 
          local cmd=i-1
          SendQ("WM4000"..cmd.."*1AU|","SentCmd")
        else
          local cmd=i-9
          SendQ("WM6000"..cmd.."*1AU|","SentCmd")
        end
      else
        if i<9 then 
          local cmd=i-1
          SendQ("WM4000"..cmd.."*0AU|","SentCmd")
        else
          local cmd=i-9
          SendQ("WM6000"..cmd.."*0AU|","SentCmd")
        end
      end
    end
  end
  
  Mark.EventHandler=function()
    SendQ("WBRCDR|","SentCmd")
  end
  
  Record.EventHandler=function()
    SendQ("WY1RCDR|","SentCmd")
    RecTimer:Start(RecTime)
    recTimer=true
  end
  
  Pause.EventHandler=function()
    SendQ("WY2RCDR|","SentCmd")
    RecTimer:Stop()
    recTimer=false
  end
  
  Stop.EventHandler=function()
    SendQ("WY0RCDR|","SentCmd")
    RecTimer:Stop()
    recTimer=false
  end
  
    -- Video Configuration
  TestPat.EventHandler=function()
    for i=1,9 do
      SelPat=string.find(TestPatOpt[i],TestPat.String)
      if SelPat then
        local cmd=i-1
        SendQ("W0"..cmd.."TEST|","SentCmd")
        --DisplayTestPat(i)
      end
    end
  end
  
  VidLayout.EventHandler=function()
    for i,v in ipairs(VidLayOpt) do
      if string.match(v,VidLayout.String) then
        VidLaySel=i
      end 
    end
    SendQ("7*"..VidLaySel..".","SentCmd")
  end
  
  for i=1,2 do
    Controls.EncLayout[i].EventHandler=function()
      for ii,v in ipairs(EncLayOpt) do
        if string.match(v,Controls.EncLayout[i].String) then
          EncLaySel=ii
        end 
      end
      SendQ("4*"..i.."*"..EncLaySel..".","SentCmd") 
    end
  end
  
  for i=1,2 do
    Controls.StmLayout[i].EventHandler=function()
      for ii,v in ipairs(StmLayOpt) do
        if string.match(v,Controls.StmLayout[i].String) then
          StmLaySel=ii
        end
      end
      SendQ("3*"..i.."*"..StmLaySel..".","SentCmd") 
    end
  end
  
  RefNames.EventHandler=function()
    Heartbeat:Stop()
    VidLayOpt={}
    EncLayOpt={}
    StmLayOpt={}
    GetLayName()
  end
  
    -- Sockets
  SMP.EventHandler=function(sock,evt)
    if evt==TcpSocket.Events.Connected then
      TNCon=false
    elseif evt==TcpSocket.Events.Closed then
      ReportStatus("FAULT","Socket Closed")
      Disconnected()
      TNCon=false
    elseif evt==TcpSocket.Events.Error then
      ReportStatus("FAULT","Socket Error")
      Disconnected()
      TNCon=false
    elseif evt==TcpSocket.Events.Timeout then
      ReportStatus("FAULT","Socket Timeout")
      Disconnected()
      TNCon=false
    elseif evt==TcpSocket.Events.Reconnect then
      ReportStatus("FAULT","Socket Reconnecting")
      Disconnected()
      TNCon=false
    elseif evt==TcpSocket.Events.Data then
      if not TNCon then
        Rxdata=sock:Read(sock.BufferLength)
        if string.find(Rxdata,"Password:") then
          TelnetAuth() 
        end
        if string.find(Rxdata,"Login") then
          TelnetCon()  
        end
      else
        Rxdata=sock:ReadLine(TcpSocket.EOL.CrLf)
        ParseResponse(Rxdata)
      end
    end
  end
  
    -- Timers
  Heartbeat.EventHandler=function()
    PollDevice()
  end
  
  RecTimer.EventHandler=function()
    GetRecInfo()
  end
  
  CmdQTimer.EventHandler=function()
    if #CmdQ ~= 0 then
      Send()
    end  
  end
  
  
  -- Called on start
  Init()
end